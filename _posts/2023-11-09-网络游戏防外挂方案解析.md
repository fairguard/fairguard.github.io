---
layout: post
title: "网络游戏防外挂方案解析"
date: 2023-11-09 16:26:10 +0800
categories: 游戏安全
tags: 网络游戏  防外挂  游戏防外挂
---

“射击游戏中，一位玩家百发百中、枪枪爆头，击败35人最终吃鸡”  

“刚刷新的世界boss，被铺天盖地的小号抢走了奖励，并交易出了天价”  

“游戏排行榜被角色练度低的小号霸占，引起氪金玩家不满”<!-- more -->  

网络游戏以多人在线实时对抗、互动的玩法得到了众多玩家的青睐，而类似于上述的游戏场景正不断地出现在游戏中，破坏游戏的公平性，造成正常付费玩家不满，甚至会导致玩家大量流失、厂商收益直接受损、游戏生命周期缩短等严重后果。  

造成这一局面的罪魁祸首，就是“外挂”。在游戏安全对抗中，如何高效检测外挂，是保证游戏健康、平稳运营的关键。  

本期图文我们将通过实际案例，为大家分析常见外挂的实现原理并分享网络游戏防外挂解决方案。  

![315_21](/assets/res/202103/负面.png)  
数据显示：超半数的玩家遇到过盗号、外挂、BUG等状况  

游戏外挂是指进行非正常游戏的作弊程序或软件。一般会通过某种方式，将自身程序植入到游戏程序中，截取并修改本地、或欺骗服务器下发的数据，从而实现一系列意想不到的作弊效果。常见的游戏外挂分为四类：内存挂、封包挂、注入挂、模拟点击挂。  

**内存挂案例分析**  

内存修改外挂是最常见的外挂种类，实现原理是通过内存修改器来搜索、定位游戏内存，再对数值模块进行修改。  

针对游戏不同类型与玩法，内存修改外挂会造成不同程度的危害，如：修改游戏内角色的攻击力的秒杀挂，修改游戏交易货币数量的无限金币挂、修改游戏关键道具数量等，这类外挂会严重破坏游戏的公平性，引发正常玩家不满。  

![315_21](/assets/res/202103/修改金币数值.gif)  
通过修改商品售价实现无消耗购买道具  

**封包挂案例分析**  

在游戏运行过程中，我们点击某个按钮或进行某种游戏行为的时候，客户端会按照跟服务器约定好的规则，将游戏行为请求和参数通过网络封包发送给服务器，服务器收到请求后做出解析，将信息处理后反馈回客户端，客户端再将反馈信息进行解析展示给玩家。  

![315_21](/assets/res/202103/协议破解后交互流程.png)  
通讯协议破解后的客户端服务器交互  

破解者通常会使用抓包工具，获得游戏封包数据。当破解者抓取到了封包数据并破解后，即可随意篡改游戏内上下行的数据，如游戏角色攻击力、生命值、游戏内胜负逻辑、投降判负逻辑等，从而实现一系列外挂功能。

![315_21](/assets/res/202103/通讯协议vpn外挂.png)  
某封包挂，可以调整角色攻击生命等数值及胜负逻辑  

**注入挂案例分析**  

注入挂，顾名思义是将外挂模块注入到游戏进程空间中，同时执行功能模块的入口函数，多涉及内存操作且功能丰富。  

从注入过程上，Android系统一般采用SO注入、ptrace注入、 Zygote注入及感染ELF文件的方式。iOS系统在越狱后可以利用Cydia框架注入dylib实现。  

开启外挂并成功注入游戏后，通过外挂界面引导玩家使用功能，随后调用接口函数以HOOK操作来挂钩相应函数、改写参数或者通过调用逻辑，从而实现外挂功能。  

![315_21](/assets/res/202103/lsposed.png)  
自带隐藏模块的LSPosed框架  

与其他外挂类型相比，注入挂修改游戏代码逻辑的方式更加灵活多样，并且破解者会通过多种手段隐藏注入模块，导致注入挂的排查难度更高、排查周期更久，对游戏造成的负面影响也更加严重。  

**模拟点击挂案例分析**  

常见的模拟点击外挂可通过设置按键位置、按键顺序、按键间隔时间等参数，构造点击逻辑，通过脚本分析器去解析参数传递给相应功能接口，从而制作自动化的模拟点击脚本。  

![315_21](/assets/res/202103/脱机脚本.gif)  
网游中的自动挂机脚本  

在特定的游戏环境下，选择模拟点击方案，从而实现自动打怪，自动任务，自动挂机领奖励等功能。这类模拟点击外挂，会对游戏平衡造成极大影响，破坏正常玩家游戏体验。  

面对日益复杂的游戏外挂侵扰，游戏厂商亟需一支强大、专业的游戏安全队伍。FairGuard以技术为驱动，研发了多项业界独家技术，搭建了针对不同游戏场景的防护矩阵，提供全方位的网络游戏防外挂解决方案。  

**反外挂功能**  

针对游戏将面临一系列外挂修改风险，FairGuard研发了行为检测方案，搭配200+维度的智能感知系统，可通杀各类外挂及其变种，做到有效防护。  

**主动识别恶意模块机制**  

区别于市面上其他安全产品，需要获取样本后进行外挂打击，FairGuard独家「主动识别恶意模块机制」可对游戏内可疑模块进行主动识别，搭配在线打击功能做到主动防御，大幅缩短外挂排查周期。  

**反注入器功能**  

禁止使用Xposed、Frida等各种外挂模块注入器，防止注入后修改游戏内存等各种恶意行为，一旦发现立即闪退。  

**数据校验功能**  

FairGuard提供数据校验功能，可精准校验游戏上下行数据，保证游戏通讯协议安全，避免出现封包挂、私服问题。  

**工作室定位**

FairGuard独家方案，可对无特征的私有脚本进行智能分析挖掘，定位并标记出工作室账号，可自动对接给游戏方进行封号处理，做到高效防护。  

**丨结语**  

FairGuard作为专注于游戏安全领域的第三方服务商，致力于帮助游戏公司解决外挂和破解问题，为游戏提供深度一体化的加密保护方案。  

目前产品已经被FunPlus、三七互娱、恺英网络、心动、杭州电魂等多家头部公司采用，接入400+款热门游戏。欢迎访问 [www.fair-guard.com](https://www.fair-guard.com) 了解试用。    

产品咨询联系方式：  

QQ：2079128588  

微信：fairguard01  

技术交流QQ群：1105310296  