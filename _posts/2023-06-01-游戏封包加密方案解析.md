---
layout: post
title: "游戏封包加密方案解析"
date: 2023-06-01 16:26:10 +0800
categories: 游戏安全
tags: 反外挂  游戏封包  封包加密
---

当下游戏市场已全面回暖，暑期档临近更将迎来大量新游上线，如此关键节点，游戏厂商应当更加注重游戏安全。<!-- more -->  

FairGuard发现近期游戏黑灰产攻击角度愈发刁钻，除了常见的内存修改外挂、注入挂，针对游戏封包破解的「脱机挂」数量有所上涨，如何有效对游戏封包加密成为一大痛点。  

想要了解游戏封包加密，我们先来了解一下游戏客户端与服务端之间的运作流程，以及游戏封包在其中的作用。  

![315_21](/assets/res/202103/正常交互流程.png)  
正常情况下游戏客户端服务器交互  

在游戏运行过程中，我们点击某个按钮或进行某种游戏行为的时候，客户端会按照跟服务器约定好的规则，将游戏行为请求和参数通过网络封包发送给服务器，服务器收到请求后做出解析，将信息处理后反馈回客户端，客户端再将反馈信息进行解析展示给玩家。  

在这个过程中，游戏封包又是如何被破解的呢?  

答案是采用了「抓包工具」，一种网络数据包编辑器。常见两类实现方式，一类是基于硬件，比如让网卡处于混乱模式，即可拦截数据包进行反编译;另一类则是通过HOOK手段，针对 send 和 recv 类函数进行拦截，获得游戏封包数据。  

![315_21](/assets/res/202103/抓包工具.png)  
抓包工具WPE  

当破解者抓取到了封包数据并破解后，即可随意篡改游戏内上下行的数据，如游戏角色攻击力、生命值、游戏内胜负逻辑、投降判负逻辑等，从而实现一系列外挂功能。  

![315_21](/assets/res/202103/协议破解后交互流程.png)  
通讯协议破解后的客户端服务器交互  

以FairGuard收集的某外挂样本为例，该外挂功能表现为将失败变为获胜、将投降变为获胜。  

其实现原理就是使用「抓包工具」对游戏封包进行解析，破解通讯协议后，使用VPN搭载在封包数据传输过程中，将封包中的数据、逻辑进行篡改。  

![315_21](/assets/res/202103/通讯协议vpn外挂.png)  

除此之外，游戏封包被破解还会出现脱机挂，常见于工作室批量起号。  

封包被破解后，工作室可脱离游戏客户端的限制，编写脚本直接向游戏服务器发送各类操作指令，从而实现低成本、快速、批量起号。  

结合以往案例，一台电脑一个脚本，一天可以跑出上万个工作室账号，会占用大量服务器资源，并且对游戏内的经济系统，玩家的付费意愿与游戏公平性造成极大影响。  

![315_21](/assets/res/202103/脱机脚本.gif)  
某游戏脱机脚本  

某游戏曾出现过这类脱机挂，表现为大量工作室账号刷取游戏内金币，外挂作者通过各种渠道散播、售卖外挂，非法牟利超500万元人民币，对游戏造成了巨大的损失。  

面对日益庞大的游戏黑灰产，游戏厂商需要一支强大、专业的游戏安全队伍，FairGuard针对上述的游戏封包被破解产生的外挂问题，提供定制化解决策略，该游戏封包加密方案已接入多款热门游戏并验证了出色的保护能力。  

**签名校验功能**  

在技术层面，我们通过独有的高混淆度加密算法，有效提高分析、破解的门槛，可拦截大部分破解操作;  

在日常运营层面，搭配使用数据校验功能，可精准校验游戏上下行数据，一旦发现数据异常，立刻上报处理，真正做到有效防护。  

**丨结语**  

FairGuard作为专注于游戏安全领域的第三方服务商，致力于帮助游戏公司解决外挂和破解问题，为游戏提供深度一体化的加密保护方案。  

目前产品已经被FunPlus、三七互娱、恺英网络、心动、杭州电魂等多家头部公司采用，接入400+款热门游戏。欢迎访问 [www.fair-guard.com](https://www.fair-guard.com) 了解试用。    

产品咨询联系方式：  

QQ：2079128588  

微信：fairguard01  

技术交流QQ群：1105310296  