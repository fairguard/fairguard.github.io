---
layout: post
title: "FairGuard无API签名校验方案解析"
date: 2024-11-28 16:26:10 +0800
categories: 游戏安全
tags: 签名校验  游戏加密  防破解
---

众所周知，Android系统在安装游戏时，为了确保游戏包没有被篡改，会验证游戏文件的真实性与完整性，此时就需要对游戏包进行签名校验，校验无误后才能安装成功。<!-- more -->  

签名相当于在游戏包体中写入一个指纹，指纹写入以后，包体有任何修改，都会导致这个指纹无效，从而在安装的签名校验过程中，将盗版、破解版游戏排除在外。  

为了保证安全性与唯一性，签名由摘要与私钥签名两部分组成，校验时会使用相同的哈希算法计算出摘要，并使用私钥对签名信息进行解密，将解密出来的数据和摘要进行比对，如果两者相同，则说明游戏并没有被篡改。  

![315_21](/assets/res/202103/签名流程.png)  
游戏签名和签名校验的过程  

而破解者制作盗版游戏时，通常会使用逆向修改工具，如Android系统常见的MT管理器就带有去除签名校验。  

去除签名校验之后，就可以通过各种分析调试手段来修改游戏内数值、游戏逻辑、植入功能菜单，从而制作盗版、破解版游戏。  

![315_21](/assets/res/去除签名校验.jpg)  
MT管理器去除签名校验功能  

那么这些被篡改内容的盗版、破解版游戏又是如何通过签名校验的呢?  

答案是：通过hook API函数的方式伪造正版签名，让正常的签名校验失效。  

具体原理与操作如下：  

API(应用程序接口)是一种定义了应用程序与操作系统或其他软件之间交互的规范，其中包含大量的系统函数。  

正常情况下，游戏的运行与交互需要通过调用API来执行，随后将结果返回给游戏客户端，再呈现给用户。  

![315_21](/assets/res/202103/hookapi.png)  
hook API 流程示意图  

而hook API之后，就相当于拦截了正常的交互，可以将自定义的程序穿插在其中，从而在不修改原始代码的情况下，拦截和改变程序的执行流程。  

体现在伪造签名过程则为：破解者将带正版签名的包体与破解版包体整合在一起，在游戏启动进行签名校验时，获取到的是正版签名，而游戏运行时则是破解版包体内容。  

这一点往往也会体现在包体大小上，破解版的包体大小近乎为正版的两倍。  

![315_21](/assets/res/202103/正版破解版对比.png)  
某游戏正版与破解版包体大小对比  

对于一款游戏而言，流出破解版会导致游戏的公平性被破坏，造成正版玩家大量流失，而且游戏内的代码、美术资源也存在被盗用、被剧透的可能。  

针对游戏面临的被破解风险，FairGuard定制了专门的应对策略，该方案已接入多款热门游戏并验证了出色的保护能力。  

防破解功能  

FairGuard业界独家「无API签名校验技术」，对游戏的引擎与代码进行深度加密，并对游戏包签名和文件完整性进行多重校验，极大地减少被绕过的可能性，防止游戏被植入恶意模块、剔除广告等行为。  

主动识别恶意模块机制  

区别于市面上其他安全产品，需要获取样本后进行外挂打击，FairGuard独家「主动识别恶意模块机制」可对游戏内可疑模块进行主动识别，搭配在线打击功能做到主动防御，大幅缩短外挂排查周期。  

反调试功能  

防止外挂作者对游戏进行调试，阻止对游戏的静态或动态分析，一旦发现立即闪退。  

安全环境检测功能  

不同于市面上其他产品，FairGuard加固采用更底层的检测手段，可精准识别虚拟框架、虚拟机、越狱、ROOT、云手机等各类风险环境，并提供个性化闪退策略。  


**丨结语**  

FairGuard作为专注于游戏安全领域的第三方服务商，致力于帮助游戏公司解决外挂和破解问题，为游戏提供深度一体化的加密保护方案。  

目前产品已经被FunPlus、三七互娱、恺英网络、心动、杭州电魂等多家头部公司采用，接入500+款热门游戏。欢迎访问 [www.fair-guard.com](https://www.fair-guard.com) 了解试用。    

产品咨询联系方式：  

QQ：2079128588  

微信：fairguard01  

技术交流QQ群：1105310296  