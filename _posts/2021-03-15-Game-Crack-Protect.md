---
layout: post
title:  "芥子空间破解游戏的加固保护案例"
date:   2021-03-15 13:50:10  +0800
categories: 案例
tags:  芥子空间 客户案例 游戏保护 去广告
---
最近有个咨询加固的游戏反映，他们游戏在芥子空间上被发布破解版本。破解版功能除了去除广告外，还包含很多对玩家有很大吸引力的修改功能，导致大量的正版用户流失，对游戏营收产生了很大的负责影响。

![315_21](/assets/res/202103/315_21.png)

芥子空间上提供大量的破解版游戏下载，很多热门的游戏都有提供。破解版下载页面如下图所示：

![315_22](/assets/res/202103/315_22.png)

破解版提供的功能：

![315_22](/assets/res/202103/315_23.png)

后该游戏使用加固进行了一周的试用。期满后，咨询试用情况，游戏反馈如下图：

![315_22](/assets/res/202103/315_24.png)

游戏反馈说发布5天后在芥子空间出现了破解版，不过可能是觉得相比之前的破解情况有很大改善，已经决定签合同付费了。

FairGuard上线大半年，到目前为止，还没有被破解的情况出现。难道在这个游戏面前破了金身？本着公司创立以来的极客精神，我们不能接受出现破解版还付费的情况发生。

​     FairGuard的技术人员接下来对此情况进行了排查分析。

从芥子空间上下载该游戏到电脑上分析，发现签名跟原版游戏是一样的。找游戏方对比发布的原始游戏包，MD5值也是一致的。确定游戏没有被篡改。芥子空间并没有能破解加固后的游戏。

但是从芥子空间下载的游戏进入界面后，发现现金被篡改了，高达9.9亿，如下图所示：

![315_22](/assets/res/202103/315_25.png)

卸载掉芥子空间下载的游戏，重新安装官方的游戏包，现金只有21万，界面如下图所示：

![315_22](/assets/res/202103/315_26.png)

问题就比较奇怪了，游戏没有被破解，但是现金却被修改了。

经过FairGuard技术人员的深入分析，发现是芥子空间安装的时候做了手脚。游戏安装后还没启动前，芥子空间在sdcard的游戏使用目录下释放了修改过的存档文件：

![315_22](/assets/res/202103/315_27.png)

就是红框的cache.byte文件，这个文件即是篡改过现金值的存档文件。

正常情况下，游戏不会使用sdcard作为存档保存目录，这种篡改也不会有效果。但是该游戏使用这样的风险操作，并且在启动的时候，优先去加载sdcard下的存档，这给了芥子空间篡改存档的机会。

将sdcard作为存档目录的风险在于，存档可被别的应用读写、修改，因为Android系统的sd卡没有权限限制，任何应用都可以读写。

这种破解已经不属于游戏加固能解决的范围，需要游戏遵循一些安全规范才能解决。建议游戏不要将存档放到sdcard上，而是放到手机的内部存储目录，这样类似芥子空间的应用就没有权限去对存档文件做写操作。

另外也可以使用FairGuard的存档加密功能，该加密可让存档拷贝到别的手机上即无法解析。

**游戏研发根据FairGuard提供的安全建议，将手机内部存储作为存档读写目录后，未再出现破解版本。**

&nbsp;
&nbsp;

**FairGuard 专注于游戏加固与[反外挂](https://www.fair-guard.com/index/pro.html?id=361)，致力于打造业界顶尖的游戏保护方案。**

研发了 SO 无导入函数加壳、iOS AB 资源加密、global-metadata 加密、虚拟机底层指纹检测等多项独家保护功能。目前已被 FunPlus、三七互娱、游族等多家头部游戏公司采用。

&nbsp;

有兴趣的可以加入FairGuard技术交流QQ群:1105310296

也可以关注FairGuard微信公众号：

![wechat](/assets/res/wechat.jpg)